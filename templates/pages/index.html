{% extends 'base.html' %}
{% load static %}

{% block title %}{{ site_info.site_name }} - Équipement Médical Premium{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
<link rel="stylesheet" href="{% static 'css/mediaQuery.css' %}">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero">
  <h1>{{ site_info.hero_title }}</h1>
  <p>{{ site_info.hero_subtitle }}</p>
  <div class="hero-buttons">
    <a href="{% url 'pages:contact' %}" class="btn btn-call">Appelez-nous</a>
    {% if user.is_authenticated %}
      <a href="{% url 'accounts:dashboard' %}" class="btn btn-login">Tableau de Bord</a>
    {% else %}
      <a href="{% url 'accounts:login' %}" class="btn btn-login">Connexion</a>
    {% endif %}
  </div>
</section>

<!-- About Us Section -->
<section class="about-us-section">
  <div class="about-us-container">
    <div class="about-us-image">
      <img src="{% static 'images/aboutUs-section.png' %}" alt="{{ site_info.site_name }}" />
    </div>
    <div class="about-us-content">
      <h2>{{ site_info.about_section_title }}</h2>
      {% if site_info.about_hero_description %}
        {{ site_info.about_hero_description|safe }}
      {% else %}
        <p>
          Fennec Med est votre partenaire de confiance pour l'acquisition d'équipements médicaux 
          de qualité en Algérie. Basés à Sétif, nous proposons une large gamme de produits 
          certifiés aux professionnels de santé et aux particuliers. Notre équipe expérimentée 
          vous accompagne dans le choix des meilleures solutions adaptées à vos besoins, avec 
          un service après-vente exceptionnel et des prix compétitifs.
        </p>
      {% endif %}
      <a href="{% url 'pages:about' %}" class="btn btn-learn-more">En Savoir Plus Sur Nous</a>
    </div>
  </div>
</section>

<!-- Products Section -->
{% if featured_products %}
<section class="products-section">
  <h2 class="h2-p">Nos Produits</h2>
  <div class="products-container">
    {% for product in featured_products %}
    <div class="product-card">
      <div class="product-image">
        {% if product.images.first %}
          <img src="{{ product.images.first.image.url }}" alt="{{ product.name }}" />
        {% else %}
          <img src="{% static 'images/prdct1.png' %}" alt="{{ product.name }}" />
        {% endif %}
      </div>
      <h3>{{ product.short_description|truncatechars:80 }}</h3>
      {% with price_range=product.get_price_range %}
        {% if price_range.0 == price_range.1 %}
          <p class="product-price">DZD {{ price_range.0 }}</p>
        {% elif price_range.0 > 0 %}
          <p class="product-price">DZD {{ price_range.0 }} - {{ price_range.1 }}</p>
        {% else %}
          <p class="product-price">Prix sur demande</p>
        {% endif %}
      {% endwith %}
      <a href="{{ product.get_absolute_url }}" class="btn btn-view-details">Voir les Détails</a>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

<!-- Specialties Section -->
<section class="specialties-section">
  <h2 class="h2-specialty">Nos Spécialités</h2>
  <div class="specialties-container">
    {% for category in categories %}
    <div class="specialty-card">
      <div class="specialty-icon">
          {% if category.image %}
          <a href="{% url 'products:list' %}?category={{ category.slug }}">
            <img src="{{ category.image.url }}" alt="Icône {{ category.name }}" />
          </a>
          {% else %}
          <a href="{% url 'products:list' %}?category={{ category.slug }}">
            <img src="{% static 'images/specialties-'|add:category.slug|add:'.png' %}" alt="Icône {{ category.name }}" />
          </a>
          {% endif %}
      </div>
      <h3>{{ category.name }}</h3>
    </div>
    {% endfor %}
  </div>
</section>

<!-- Testimonials -->
{% if testimonials %}
<section class="testimonial-section">
  <h2>Ce Que Disent Nos Clients</h2>
  <div class="testimonial-container">
    {% for testimonial in testimonials %}
    <div class="testimonial-card">
      <p class="testimonial-text">
        "{{ testimonial.content }}"
      </p>
      <p class="testimonial-author">- {{ testimonial.name }}</p>
      <div class="rating">
        {% for i in "12345" %}
          {% if forloop.counter <= testimonial.rating %}★{% else %}☆{% endif %}
        {% endfor %}
      </div>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

<!-- Trending Products -->
{% if trending_products %}
<section class="products-section" style="background-color: #f0f4f8;">
  <h2 class="h2-p" style="color: #34588f;">Produits Tendance</h2>
  <div class="products-container">
    {% for product in trending_products %}
    <div class="product-card">
      <div class="product-image">
        {% if product.images.first %}
          <img src="{{ product.images.first.image.url }}" alt="{{ product.name }}" />
        {% else %}
          <img src="{% static 'images/prdct1.png' %}" alt="{{ product.name }}" />
        {% endif %}
      </div>
      <h3>{{ product.short_description|truncatechars:80 }}</h3>
      {% with price_range=product.get_price_range %}
        {% if price_range.0 == price_range.1 %}
          <p class="current-price">DZD {{ price_range.0 }}</p>
        {% elif price_range.0 > 0 %}
          <p class="current-price">DZD {{ price_range.0 }} - {{ price_range.1 }}</p>
        {% else %}
          <p class="current-price">Prix sur demande</p>
        {% endif %}
      {% endwith %}
      <a href="{{ product.get_absolute_url }}" class="btn btn-view-details">Voir les Détails</a>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

<!-- Find Us Section -->
{% if site_info.find_us_content %}
<section class="find-us-section">
  <h2>Où Nous Trouver</h2>
  {{ site_info.find_us_content|safe }}
</section>
{% endif %}

{% if site_info.map_embed_url %}
<section class="map-section">
  <div class="map-container">
    <iframe
      src="{{ site_info.map_embed_url }}"
      width="100%"
      height="450"
      style="border: 0"
      allowfullscreen=""
      loading="lazy"
    ></iframe>
  </div>
</section>
{% endif %}

<!-- CTA Section -->
<section class="cta-section">
  <h2>{{ site_info.cta_title }}</h2>
  <p>{{ site_info.cta_description }}</p>
  {% if user.is_authenticated %}
    <a href="{% url 'products:list' %}" class="btn btn-cta">Parcourir les Produits</a>
  {% else %}
    <a href="{% url 'accounts:register' %}" class="btn btn-cta">Commencer</a>
  {% endif %}
</section>
{% endblock %}

{% block extra_js %}
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<script src="{% static 'js/index.js' %}"></script>
{% endblock %}