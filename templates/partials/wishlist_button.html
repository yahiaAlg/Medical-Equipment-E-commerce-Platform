{% if user.is_authenticated %}
    <form class="wishlist-form" method="post" action="{% url 'accounts:wishlist_toggle' product.id %}">
        {% csrf_token %}
        <button type="submit" class="wishlist-btn {% if product in wishlist_products %}in-wishlist{% endif %}" 
                data-product-id="{{ product.id }}"
                title="{% if product in wishlist_products %}Remove from wishlist{% else %}Add to wishlist{% endif %}">
            {% if product in wishlist_products %}
                <!-- Filled Heart SVG -->
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                </svg>
            {% else %}
                <!-- Outline Heart SVG -->
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                </svg>
            {% endif %}
        </button>
    </form>
{% else %}
    <button class="wishlist-btn" onclick="window.location.href='{% url 'accounts:login' %}?next={{ request.path }}'" 
            title="Login to add to wishlist">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
    </button>
{% endif %}

<style>
.btn-wishlist {
    background: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    cursor: pointer;
    transition: all 0.3s;
    color: #34588f;
    font-size: 1.25rem;
}

.btn-wishlist:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.btn-wishlist .fa-heart {
    transition: all 0.2s;
}

.btn-wishlist:hover .fa-heart {
    transform: scale(1.1);
}

.wishlist-form {
    margin: 0;
}




</style>