{% extends 'base.html' %}
{% load static %}

{% block title %}Manage Complaint Reasons - Fennec Med{% endblock %}

{% block extra_css %}
<style>
.admin-header {
  background: linear-gradient(135deg, #34588f 0%, #1a3e75 100%);
  color: white;
  padding: 2rem 0;
  margin-bottom: 2rem;
}

.card-custom {
  background: white;
  border-radius: 10px;
  padding: 2rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  margin-bottom: 1.5rem;
}

.reason-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  margin-bottom: 0.75rem;
  transition: all 0.3s;
}

.reason-item:hover {
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.reason-info {
  flex: 1;
}

.reason-badge {
  padding: 0.3rem 0.7rem;
  border-radius: 15px;
  font-size: 0.8rem;
  font-weight: 600;
  margin-left: 0.5rem;
}

.reason-badge.active {
  background: #d4edda;
  color: #155724;
}

.reason-badge.inactive {
  background: #f8d7da;
  color: #721c24;
}

.reason-actions {
  display: flex;
  gap: 0.5rem;
}
</style>
{% endblock %}

{% block content %}
<div class="admin-header">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h1><i class="fas fa-tags me-2"></i>Manage Complaint Reasons</h1>
        <p class="mb-0">Configure available complaint reason options</p>
      </div>
      <a href="{% url 'accounts:admin_complaints_management' %}" class="btn btn-light">
        <i class="fas fa-arrow-left me-2"></i>Back to Complaints
      </a>
    </div>
  </div>
</div>

<div class="container mb-5">
  <div class="row">
    <!-- Add New Reason Form -->
    <div class="col-lg-5 mb-4">
      <div class="card-custom">
        <h5 class="mb-4"><i class="fas fa-plus-circle me-2"></i>Add New Reason</h5>
        
        <form method="post">
          {% csrf_token %}
          
          <div class="mb-3">
            <label class="form-label"><strong>Reason Name *</strong></label>
            {{ form.name }}
          </div>
          
          <div class="mb-3">
            <label class="form-label"><strong>Description</strong></label>
            {{ form.description }}
          </div>
          
          <div class="mb-3">
            <label class="form-label"><strong>Display Order</strong></label>
            {{ form.display_order }}
            <small class="form-text text-muted">Lower numbers appear first</small>
          </div>
          
          <div class="mb-3 form-check">
            {{ form.is_active }}
            <label class="form-check-label" for="{{ form.is_active.id_for_label }}">
              <strong>Active</strong>
            </label>
          </div>
          
          <div class="d-grid">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save me-2"></i>Add Reason
            </button>
          </div>
        </form>
      </div>
    </div>
    
    <!-- Existing Reasons List -->
    <div class="col-lg-7 mb-4">
      <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h5><i class="fas fa-list me-2"></i>Existing Reasons</h5>
          <span class="badge bg-primary">{{ reasons|length }} total</span>
        </div>
        
        {% if reasons %}
          {% for reason in reasons %}
          <div class="reason-item">
            <div class="reason-info">
              <div class="d-flex align-items-center mb-2">
                <strong>{{ reason.name }}</strong>
                <span class="reason-badge {% if reason.is_active %}active{% else %}inactive{% endif %}">
                  {% if reason.is_active %}Active{% else %}Inactive{% endif %}
                </span>
                <span class="badge bg-secondary ms-2">Order: {{ reason.display_order }}</span>
              </div>
              {% if reason.description %}
              <p class="text-muted mb-0 small">{{ reason.description }}</p>
              {% endif %}
            </div>
            
            <div class="reason-actions">
              <form method="post" action="{% url 'accounts:admin_toggle_complaint_reason' reason.id %}" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm {% if reason.is_active %}btn-warning{% else %}btn-success{% endif %}" 
                        title="{% if reason.is_active %}Deactivate{% else %}Activate{% endif %}">
                  <i class="fas fa-{% if reason.is_active %}times{% else %}check{% endif %}"></i>
                </button>
              </form>
            </div>
          </div>
          {% endfor %}
        {% else %}
          <div class="text-center text-muted py-5">
            <i class="fas fa-inbox fa-3x mb-3 d-block"></i>
            <p>No complaint reasons configured yet</p>
          </div>
        {% endif %}
      </div>
      
      <!-- Instructions -->
      <div class="alert alert-info">
        <h6><i class="fas fa-info-circle me-2"></i>Instructions</h6>
        <ul class="mb-0 small">
          <li>Complaint reasons help customers categorize their issues</li>
          <li>Only active reasons will be visible to customers</li>
          <li>Display order controls the sequence in dropdown menus</li>
          <li>Always provide a clear, descriptive name for each reason</li>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}