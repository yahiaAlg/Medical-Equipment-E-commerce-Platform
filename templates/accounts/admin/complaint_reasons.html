{% extends 'base.html' %}
{% load static %}

{% block title %}Gérer les motifs de réclamation - Fennec Med{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/admin/complaint_reasons.css' %}">
{% endblock %}

{% block content %}
<div class="admin-header">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h1><i class="fas fa-tags me-2"></i>Gérer les motifs de réclamation</h1>
        <p class="mb-0">Configurer les options de motifs de réclamation disponibles</p>
      </div>
      <a href="{% url 'accounts:admin_complaints_management' %}" class="btn btn-light">
        <i class="fas fa-arrow-left me-2"></i>Retour aux réclamations
      </a>
    </div>
  </div>
</div>

<div class="container mb-5">
  <div class="row">
    <!-- Add New Reason Form -->
    <div class="col-lg-5 mb-4">
      <div class="card-custom">
        <h5 class="mb-4"><i class="fas fa-plus-circle me-2"></i>Ajouter un nouveau motif</h5>
        
        <form method="post">
          {% csrf_token %}
          
          <div class="mb-3">
            <label class="form-label"><strong>Nom du motif *</strong></label>
            {{ form.name }}
          </div>
          
          <div class="mb-3">
            <label class="form-label"><strong>Description</strong></label>
            {{ form.description }}
          </div>
          
          <div class="mb-3">
            <label class="form-label"><strong>Ordre d'affichage</strong></label>
            {{ form.display_order }}
            <small class="form-text text-muted">Les numéros les plus bas apparaissent en premier</small>
          </div>
          
          <div class="mb-3 form-check">
            {{ form.is_active }}
            <label class="form-check-label" for="{{ form.is_active.id_for_label }}">
              <strong>Actif</strong>
            </label>
          </div>
          
          <div class="d-grid">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save me-2"></i>Ajouter le motif
            </button>
          </div>
        </form>
      </div>
    </div>
    
    <!-- Existing Reasons List -->
    <div class="col-lg-7 mb-4">
      <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h5><i class="fas fa-list me-2"></i>Motifs existants</h5>
          <span class="badge bg-primary">{{ reasons|length }} au total</span>
        </div>
        
        {% if reasons %}
          {% for reason in reasons %}
          <div class="reason-item">
            <div class="reason-info">
              <div class="d-flex align-items-center mb-2">
                <strong>{{ reason.name }}</strong>
                <span class="reason-badge {% if reason.is_active %}active{% else %}inactive{% endif %}">
                  {% if reason.is_active %}Actif{% else %}Inactif{% endif %}
                </span>
                <span class="badge bg-secondary ms-2">Ordre : {{ reason.display_order }}</span>
              </div>
              {% if reason.description %}
              <p class="text-muted mb-0 small">{{ reason.description }}</p>
              {% endif %}
            </div>
            
            <div class="reason-actions">
              <form method="post" action="{% url 'accounts:admin_toggle_complaint_reason' reason.id %}" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm {% if reason.is_active %}btn-warning{% else %}btn-success{% endif %}" 
                        title="{% if reason.is_active %}Désactiver{% else %}Activer{% endif %}">
                  <i class="fas fa-{% if reason.is_active %}times{% else %}check{% endif %}"></i>
                </button>
              </form>
            </div>
          </div>
          {% endfor %}
        {% else %}
          <div class="text-center text-muted py-5">
            <i class="fas fa-inbox fa-3x mb-3 d-block"></i>
            <p>Aucun motif de réclamation configuré pour le moment</p>
          </div>
        {% endif %}
      </div>
      
      <!-- Instructions -->
      <div class="alert alert-info">
        <h6><i class="fas fa-info-circle me-2"></i>Instructions</h6>
        <ul class="mb-0 small">
          <li>Les motifs de réclamation aident les clients à catégoriser leurs problèmes</li>
          <li>Seuls les motifs actifs seront visibles par les clients</li>
          <li>L'ordre d'affichage contrôle la séquence dans les menus déroulants</li>
          <li>Fournissez toujours un nom clair et descriptif pour chaque motif</li>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}